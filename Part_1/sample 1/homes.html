<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Home & Kitchen Reviews</title>
  <link rel="stylesheet" href="allcss.css">

</head>

<body>

  <header>
    <h1>Home & Kitchen Review </h1>
    <p>Home & Kitchen Appliances With Real Insights & Experiences</p>
    <a href=".././../index.html" class="home-btn">üè† Home</a>

  </header>

  <div class="container">
    <section>

      <div class="grid" id="cards-container">

        <div class="card" data-type="product" data-name="Air Conditioner">
          <div class="card-image">
            <img src="./photo/ac.jpg" alt="Air Conditioner">
          </div>
          <div class="card-content">
            <h3>Air Conditioner</h3>
            <p>An air conditioner is an essential home appliance that keeps your living space cool and comfortable, especially during hot summer months. Modern ACs come in various types like split, window, portable, and inverter models, each designed to suit different room sizes and cooling needs. They not only regulate temperature but also improve air quality by filtering dust and allergens. Energy-efficient models save electricity while providing optimal cooling</p>
            <div class="reviews-list"><p>No reviews yet.</p></div>
            <div class="review-section">
            <textarea placeholder="Write your review..."></textarea>
              <button class="btn" onclick="submitReview(this)">Submit Review</button>
            </div>
          </div>
        </div>

        <div class="card" data-type="product" data-name="Refrigerator">
          <div class="card-image">
            <img src="./photo/Refrigerator.avif" alt="Refrigerator">
          </div>
          <div class="card-content">
            <h3>Refrigerator</h3>
            <p>A refrigerator is a must-have home appliance that keeps your food fresh and beverages cool. It comes in various types such as single-door, double-door, side-by-side, and smart refrigerators, catering to different family sizes and storage needs. Modern refrigerators feature energy-efficient technology, frost-free operation, adjustable shelves, and smart cooling systems to maintain the right temperature for different types of food. Some models also include advanced features like water dispensers, ice makers, and Wi-Fi connectivity.</p>
            <div class="reviews-list"><p>No reviews yet.</p></div>
            <div class="review-section">
              <textarea placeholder="Write your review..."></textarea>
              <button class="btn" onclick="submitReview(this)">Submit Review</button>
            </div>
          </div>
        </div>

        <div class="card" data-type="product" data-name="Microwave">
          <div class="card-image">
            <img src="./photo/microwaves.jpeg" alt="Microwave">
          </div>
          <div class="card-content">
            <h3>Microwave</h3>
            <p>A microwave oven is a versatile kitchen appliance that makes cooking, reheating, and defrosting food quick and convenient. Available in various types like solo, grill, and convection models, microwaves cater to different cooking needs, from simple reheating to baking and grilling. Modern microwaves come with smart features such as preset cooking modes, timers, child locks, and sensor cooking, making them safe and easy to use.</p>
            <div class="reviews-list"><p>No reviews yet.</p></div>
            <div class="review-section">
           <textarea placeholder="Write your review..."></textarea>
              <button class="btn" onclick="submitReview(this)">Submit Review</button>
            </div>
          </div>
        </div>

      </div>
    </section>
  </div>

  <div class="blog-system">
    <h2>Write a Blog</h2>
    <input type="text" id="title" placeholder="Blog Title">
    <textarea id="content" rows="5" placeholder="Write your blog..."></textarea>
    <input type="file" id="image" accept="image/*">
    <button onclick="addBlog()">Publish</button>
  </div>

  <script>
    // =============== REVIEW SYSTEM ===============
    function createReviewElement(text, type, parentKey) {
      const div = document.createElement("div");
      div.className = "review-item";

      const span = document.createElement("span");
      span.textContent = "üìù " + text;

      const delBtn = document.createElement("button");
      delBtn.className = "delete-review-btn";
      delBtn.textContent = "‚ùå";

      // Delete review from DOM + localStorage 
      delBtn.addEventListener("click", () => {
        const reviewList = div.parentElement;
        if (type === "product") {
          let key = "product_" + parentKey;
          let reviews = JSON.parse(localStorage.getItem(key)) || [];
          reviews = reviews.filter(r => r !== text);
          localStorage.setItem(key, JSON.stringify(reviews));
          div.remove();
          if (reviews.length === 0) {
            reviewList.innerHTML = "<p>No reviews yet.</p>";
          }
        } else if (type === "blog") {
          let blogs = JSON.parse(localStorage.getItem("homeBlogs")) || [];
          let blog = blogs.find(b => b.id == parentKey);
          if (blog) {
            blog.reviews = blog.reviews.filter(r => r !== text);
            localStorage.setItem("homeBlogs", JSON.stringify(blogs));
            div.remove();
            if (blog.reviews.length === 0) {
              reviewList.innerHTML = "<p>No reviews yet.</p>";
            }
          }
        }
      });

      div.appendChild(span);
      div.appendChild(delBtn);
      return div;
    }

    function submitReview(button) {
      const card = button.closest(".card");
      const textarea = card.querySelector("textarea");
      const reviewList = card.querySelector(".reviews-list");
      const reviewText = textarea.value.trim();

      if (!reviewText) {
        alert("Please write a review!");
        return;
      }

      const type = card.dataset.type;
      const name = card.dataset.name;

      // Add to DOM
      if (reviewList.querySelector("p") && reviewList.querySelector("p").innerText === "No reviews yet.") {
        reviewList.innerHTML = "";
      }
      reviewList.appendChild(createReviewElement(reviewText, type, name));

      textarea.value = "";

      // Save to localStorage
      if (type === "product") {
        let key = "product_" + name;
        let reviews = JSON.parse(localStorage.getItem(key)) || [];
        reviews.push(reviewText);
        localStorage.setItem(key, JSON.stringify(reviews));
      } else if (type === "blog") {
        let blogs = JSON.parse(localStorage.getItem("homeBlogs")) || [];
        let index = blogs.findIndex(b => b.id == name);
        if (index > -1) {
          blogs[index].reviews.push(reviewText);
          localStorage.setItem("homeBlogs", JSON.stringify(blogs));
        }
      }
    }

    function loadProductReviews() {
      // Products
      document.querySelectorAll(".card[data-type='product']").forEach(card => {
        let name = card.dataset.name;
        let reviewList = card.querySelector(".reviews-list");
        let key = "product_" + name;
        let reviews = JSON.parse(localStorage.getItem(key)) || [];
        if (reviews.length > 0) {
          reviewList.innerHTML = "";
          reviews.forEach(r => {
            reviewList.appendChild(createReviewElement(r, "product", name));
          });
        } else {
          reviewList.innerHTML = "<p>No reviews yet.</p>";
        }
      });
    }

    // =============== BLOG SYSTEM ===============
    function addBlog() {
      let title = document.getElementById("title").value.trim();
      let content = document.getElementById("content").value.trim();
      let imageInput = document.getElementById("image").files[0];

      if (!title || !content) {
        alert("Please write something!");
        return;
      }

      let id = Date.now();

      if (imageInput) {
        let reader = new FileReader();
        reader.onload = function(e) {
          saveBlog(id, title, content, e.target.result);
        }
        reader.readAsDataURL(imageInput);
      } else {
        saveBlog(id, title, content, null);
      }
    }

    function saveBlog(id, title, content, image) {
      let blogs = JSON.parse(localStorage.getItem("homeBlogs")) || [];
      blogs.unshift({ id, title, content, image, reviews: [] });
      localStorage.setItem("homeBlogs", JSON.stringify(blogs));
      displayBlogs();

      // Clear form
      document.getElementById("title").value = "";
      document.getElementById("content").value = "";
      document.getElementById("image").value = "";
    }

    function deleteBlog(id) {
      let blogs = JSON.parse(localStorage.getItem("homeBlogs")) || [];
      blogs = blogs.filter(b => b.id != id);
      localStorage.setItem("homeBlogs", JSON.stringify(blogs));
      displayBlogs();
    }

    function displayBlogs() {
      let blogs = JSON.parse(localStorage.getItem("homeBlogs")) || [];
      let container = document.getElementById("cards-container");
      const staticCards = document.querySelector("section .grid").dataset.static || document.querySelector("section .grid").innerHTML;
      container.innerHTML = staticCards;
      loadProductReviews();

      blogs.forEach((blog, i) => {
        let div = document.createElement("div");
        div.className = "card";
        div.dataset.type = "blog";
        div.dataset.name = blog.id;

        div.innerHTML = `
          <div class="card-image">
            ${blog.image ? `<img src="${blog.image}" alt="${blog.title}">` : ""}
          </div>
          <div class="card-content">
            <h3>${blog.title}</h3>
            <p>${blog.content}</p>
            <div class="reviews-list">
              ${blog.reviews.length === 0 ? "<p>No reviews yet.</p>" : ""}
            </div>
            <div class="review-section">
              <textarea placeholder="Write your review..."></textarea>
              <button class="btn" onclick="submitReview(this)">Submit Review</button>
              <button class="btn" style="background:#c62828;margin-top:10px;" onclick="deleteBlog(${blog.id})">Delete Blog</button>
            </div>
          </div>
        `;

        // Add saved reviews
        let reviewList = div.querySelector(".reviews-list");
        blog.reviews.forEach(r => {
          reviewList.appendChild(createReviewElement(r, "blog", blog.id));
        });

        container.appendChild(div);
      });
    }

    window.onload = () => {
      const grid = document.querySelector("section .grid");
      grid.dataset.static = grid.innerHTML;
      displayBlogs();
    };
  </script>

</body>

</html>
